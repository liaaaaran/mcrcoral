---
title: "mcr_fish_vignette"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{mcr_fish_vignette}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(mcrcoral)
library(tidyverse)
library(ggplot2)
library(ggridges)
library(janitor)
library(dendextend)
library(ape)
```

```{r}
# clean dataset using janitor package
mcr_clean <- mcrcoral::mcr_fish %>%
  clean_names()
```

The following vignette shows us trends of live coral over time: clearly, as the climate crisis intensifies, we are experiencing a rapid decrease in coral. However, note how when we don't plot by site, it seems as if there is an increase in live coral starting in 2011. If we do further visualization, however, we can observe that this observation might be a little too hopeful. While there may not be a decrease in coral populations now, it seems that it has plateaus, and not risen, and in some cases continues to fall.
This is a good example of how different visualizations can lead us to different conclusions. We can see that the higher amount of coral in some sights incorrectly weighs the overall live coral rates, and can lead us to different conclusions. 
### Live Coral Over Time
```{r}
# mean live coral over time
ggplot(mcr_clean, aes(year, mean_live_coral)) + 
  geom_bar(stat = 'identity', fill = colors()[128]) + 
  scale_y_continuous() + 
  theme_bw() + 
  labs(title = "Mean Live Coral Over Time", 
        x = "Year", 
        y = "Mean Live Coral")
```
```{r}
# shows the trend of live coral over time, by SITE 
ggplot(data = mcr_clean, aes(x = year, y = mean_live_coral)) + 
  geom_line(aes(color = site)) + 
  theme_bw() + 
  labs(title = "Mean Live Coral Over Time by Site", 
        x = "Year", 
        y = "Mean Live Coral")
```
NOTE: 
For sites 4 and 5, there seems to be a continued decrease despite an increase in live coral for other sites. 
(Domain expertise): What variables should I explore that could be the cause of this? I could split the dataset into 2, and try and run analyses on ? some fish variables ? Is this caused by the fish, or is fish an effect of this?

### Mean Coral 
```{r}
mcr_site <- mcr_clean %>%
  group_by(site) %>%
  mutate(avg_pisc=mean(piscivore_primarily),
         avg_total=mean(mean_total_coral),
         avg_live=mean(mean_live_coral))
```

```{r}
# mcr_clean %>%
#   ggplot(aes(x=piscivore_primarily)) +
# #  geom_line(aes(y = piscivore_primarily)) +
#   geom_line(aes(y = mean_live_coral), data = mcr_annual, linetype = "dotdash")
```

```{r}
mcr_clean %>%
  ggplot(aes(x= piscivore_primarily, y = mean_live_coral)) +
  geom_point(aes(color = year))
```


